# ğŸ—ºï¸ Diagrama Visual do Sistema Multi-Role

## 1. Arquitetura Geral

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      All Black App                       â”‚
â”‚                    (React + Vite)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚              â”‚              â”‚
        â–¼              â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Login  â”‚    â”‚  Employeeâ”‚   â”‚  Admin â”‚
    â”‚(Mesa)  â”‚    â”‚  Login   â”‚   â”‚ Login  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚             â”‚             â”‚
         â–¼             â–¼             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚      AuthContext (Supabase)        â”‚
    â”‚  - login(user, pass, isEmployee)   â”‚
    â”‚  - logout()                        â”‚
    â”‚  - user state                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
             â”‚                     â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚        Backend - Supabase           â”‚
    â”‚        PostgreSQL + RLS             â”‚
    â”‚                                     â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ users (is_admin, is_employee)â”‚  â”‚
    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
    â”‚  â”‚ menu_items (category, active)â”‚  â”‚
    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
    â”‚  â”‚ orders (status, total)       â”‚  â”‚
    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
    â”‚  â”‚ order_items                  â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Fluxo de Login

```
START: UsuÃ¡rio acessa app
  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                         â”‚
  â–¼                                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚ Is Admin Login?  â”‚                       â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜                       â”‚
     â”‚ YES      â”‚ NO                       â”‚
     â”‚          â”‚                          â”‚
     â–¼          â–¼                          â”‚
  LOGIN       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
  ADMIN       â”‚ Is Employee?     â”‚        â”‚
  â”Œâ”€â”€â”€â”€â”€â”     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜        â”‚
  â”‚ UN  â”‚          â”‚ YES     â”‚ NO         â”‚
  â”‚ PW  â”‚          â”‚         â”‚            â”‚
  â””â”€â”€â”¬â”€â”€â”˜          â–¼         â–¼            â”‚
     â”‚         LOGIN      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
     â”‚         EMPLOYEE   â”‚  LOGIN   â”‚    â”‚
     â”‚         â”Œâ”€â”€â”       â”‚ CLIENTE  â”‚    â”‚
     â”‚         â”‚UNâ”‚       â”‚(MESA)    â”‚    â”‚
     â”‚         â”‚PWâ”‚       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â”‚
     â”‚         â””â”€â”€â”˜            â”‚          â”‚
     â”‚                         â–¼          â”‚
     â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
     â”‚                    â”‚ Mesa # â”‚      â”‚
     â”‚                    â”‚(1-99)  â”‚      â”‚
     â”‚                    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â”‚
     â”‚                        â”‚           â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜           â”‚
              â”‚             â”‚             â”‚
              â–¼             â–¼             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  Validate Credentials       â”‚ â”‚
         â”‚  (Supabase Query)           â”‚ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                     â”‚                    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
         â”‚ VALID?    â”‚          â”‚         â”‚
         â”‚ YES|NO    â”‚          â”‚         â”‚
         â–¼           â–¼          â–¼         â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”     â”‚
     â”‚Set Authâ”‚ â”‚Error â”‚   â”‚Toast â”‚     â”‚
     â”‚Context â”‚ â”‚Toast â”‚   â”‚Error â”‚     â”‚
     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”¬â”€â”€â”€â”˜     â”‚
          â”‚        â”‚          â”‚          â”‚
          â”‚        â”‚    â”Œâ”€â”€â”€â”€â”€â”˜          â”‚
          â–¼        â–¼    â–¼                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
        â”‚ Redirect to Page â”‚            â”‚
        â”‚ Based on Role    â”‚            â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                 â”‚                      â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
     â”‚           â”‚           â”‚          â”‚
     â–¼           â–¼           â–¼          â”‚
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
 â”‚CUSTOMERâ”‚ â”‚EMPLOYEE â”‚ â”‚   ADMIN  â”‚  â”‚
 â”‚ ORDER  â”‚ â”‚DASHBOARDâ”‚ â”‚DASHBOARD â”‚  â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚           â”‚           â”‚         â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                 â”‚                     â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Estados do UsuÃ¡rio (User Interface)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User State in AuthContext                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ {                                           â”‚
â”‚   id: uuid                                  â”‚
â”‚   username: string                          â”‚
â”‚   email?: string                            â”‚
â”‚   phone?: string                            â”‚
â”‚   is_admin?: boolean                        â”‚
â”‚   is_employee?: boolean     â† NOVO          â”‚
â”‚ }                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PossÃ­veis CombinaÃ§Ãµes:

1. CLIENTE
   â”œâ”€ is_admin: false
   â”œâ”€ is_employee: false
   â””â”€ Dashboard: CustomerOrder

2. FUNCIONÃRIO
   â”œâ”€ is_admin: false
   â”œâ”€ is_employee: true
   â””â”€ Dashboard: EmployeeDashboard

3. ADMINISTRADOR
   â”œâ”€ is_admin: true
   â”œâ”€ is_employee: false
   â””â”€ Dashboard: AdminDashboard

âŒ INVÃLIDO:
   â”œâ”€ is_admin: true
   â””â”€ is_employee: true
      (Sistema garante exclusividade)
```

---

## 4. Pipeline do Pedido

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PIPELINE DE PEDIDO                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CLIENTE                          FUNCIONÃRIO
   â”‚                                  â”‚
   â”œâ”€ Faz Login (Mesa 01)             â”‚
   â”œâ”€ VÃª Menu Categorizado            â”‚
   â”œâ”€ Seleciona Itens                 â”‚
   â””â”€ Confirma Pedido                 â”‚
      â”‚                               â”‚
      â”‚ INSERT order (status: pending) â”‚
      â”‚                               â”‚
      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º NotificaÃ§Ã£o
      â”‚                                â”‚
      â”‚                                â”œâ”€ VÃª Dashboard
      â”‚                                â”œâ”€ Status: pending (amarelo)
      â”‚                                â””â”€ Clica "Preparando"
      â”‚                                   â”‚
      â”‚                                   â”‚ UPDATE orders (status: preparing)
      â”‚                                   â”‚
      â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â””â”€ Acompanha status em tempo real
         (se tiver aberto)

Ciclo Completo:
pending â”€â”€â–º preparing â”€â”€â–º ready â”€â”€â–º completed
(Amarelo)   (Azul)      (Verde)    (Cinza)
```

---

## 5. Matriz de PermissÃµes (RLS)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AÃ§Ã£o           â”‚ Cliente â”‚ Func    â”‚ Admin   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ver Menu       â”‚   âœ…    â”‚   âŒ    â”‚   âœ…    â”‚
â”‚ Fazer Pedido   â”‚   âœ…    â”‚   âŒ    â”‚   âŒ    â”‚
â”‚ Ver Pedido     â”‚  PrÃ³prioâ”‚  Todos  â”‚  Todos  â”‚
â”‚ Atualizar Ped. â”‚   âŒ    â”‚   âœ…    â”‚   âœ…    â”‚
â”‚ Deletar Ped.   â”‚   âŒ    â”‚   âŒ    â”‚   âœ…    â”‚
â”‚ Editar Menu    â”‚   âŒ    â”‚   âŒ    â”‚   âœ…    â”‚
â”‚ Ver UsuÃ¡rios   â”‚   âŒ    â”‚   âŒ    â”‚   âœ…    â”‚
â”‚ Criar UsuÃ¡rio  â”‚   âŒ    â”‚   âŒ    â”‚   âœ…    â”‚
â”‚ Alterar PapÃ©is â”‚   âŒ    â”‚   âŒ    â”‚   âœ…    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Estrutura de Dados do Banco

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USERS TABLE              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id: uuid (PK)            â”‚
â”‚ username: text (UNIQUE)  â”‚
â”‚ email: text (UNIQUE)     â”‚
â”‚ phone: text              â”‚
â”‚ password_hash: text      â”‚
â”‚ is_admin: boolean        â”‚
â”‚ is_employee: boolean âœ¨  â”‚
â”‚ created_at: timestamptz  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ Indexes:
          â”œâ”€ idx_users_is_admin
          â”œâ”€ idx_users_is_employee
          â””â”€ idx_users_roles

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MENU_ITEMS TABLE         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id: uuid (PK)            â”‚
â”‚ name: text               â”‚
â”‚ description: text        â”‚
â”‚ price: decimal           â”‚
â”‚ image_url: text          â”‚
â”‚ category: text           â”‚
â”‚ active: boolean          â”‚
â”‚ created_at: timestamptz  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ Indexes:
          â””â”€ idx_menu_items_category

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ORDERS TABLE             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id: uuid (PK)            â”‚
â”‚ user_id: uuid (FKâ†’users) â”‚
â”‚ table_number: integer    â”‚
â”‚ status: text             â”‚
â”‚ total: decimal           â”‚
â”‚ payment_method?: text    â”‚
â”‚ observations?: text      â”‚
â”‚ hidden: boolean          â”‚
â”‚ created_at: timestamptz  â”‚
â”‚ updated_at: timestamptz  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ORDER_ITEMS TABLE        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id: uuid (PK)            â”‚
â”‚ order_id: uuid (FK)      â”‚
â”‚ menu_item_id: uuid (FK)  â”‚
â”‚ quantity: integer        â”‚
â”‚ price: decimal           â”‚
â”‚ created_at: timestamptz  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. Fluxo de AutenticaÃ§Ã£o Detalhado

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CLIENTE (MESA)                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   1. User digita mesa: "1"
      â†“
   2. Sistema converte: "1" â†’ "01"
      â†“
   3. Query:
      SELECT * FROM users
      WHERE username = "01"
      AND is_admin = false
      AND is_employee = false
      â†“
   4. Se encontra:
      {
        id: "...",
        username: "01",
        is_admin: false,
        is_employee: false
      }
      â†“
   5. setUser() no context
      â†“
   6. App detecta: is_admin=false && is_employee=false
      â†“
   7. Renderiza: <CustomerOrder />

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FUNCIONÃRIO                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   1. User clica "Acesso FuncionÃ¡rio"
      â†“
   2. Digita username: "funcionario"
      â†“
   3. Digita password: "func123"
      â†“
   4. Query:
      SELECT * FROM users
      WHERE username = "funcionario"
      AND is_employee = true
      AND is_admin = false
      â†“
   5. Valida password hash
      â†“
   6. Se vÃ¡lido:
      {
        id: "...",
        username: "funcionario",
        is_admin: false,
        is_employee: true
      }
      â†“
   7. setUser() no context
      â†“
   8. App detecta: is_employee=true
      â†“
   9. Renderiza: <EmployeeDashboard />

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ADMINISTRADOR                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   1. User clica "Acesso Admin"
      â†“
   2. Digita username: "admin"
      â†“
   3. Digita password: "admin123"
      â†“
   4. Query:
      SELECT * FROM users
      WHERE username = "admin"
      AND is_admin = true
      â†“
   5. Valida password hash
      â†“
   6. Se vÃ¡lido:
      {
        id: "...",
        username: "admin",
        is_admin: true,
        is_employee: false
      }
      â†“
   7. setUser() no context
      â†“
   8. App detecta: is_admin=true
      â†“
   9. Renderiza: <AdminDashboard />
```

---

## 8. Componentes e Suas Responsabilidades

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ App.tsx (Roteamento Principal)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ â”‚ if !user                            â”‚             â”‚
â”‚ â”‚   â”œâ”€ <Login />                      â”‚             â”‚
â”‚ â”‚   â”œâ”€ <EmployeeLogin />              â”‚             â”‚
â”‚ â”‚   â””â”€ <AdminLogin />                 â”‚             â”‚
â”‚ â”‚ else if user.is_admin               â”‚             â”‚
â”‚ â”‚   â””â”€ <AdminDashboard />             â”‚             â”‚
â”‚ â”‚ else if user.is_employee            â”‚             â”‚
â”‚ â”‚   â””â”€ <EmployeeDashboard />          â”‚             â”‚
â”‚ â”‚ else                                â”‚             â”‚
â”‚ â”‚   â””â”€ <CustomerOrder />              â”‚             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AuthContext.tsx (LÃ³gica de Auth)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Fornece:                                            â”‚
â”‚ â”œâ”€ user (estado)                                    â”‚
â”‚ â”œâ”€ login(user, pass, isEmployee)                   â”‚
â”‚ â””â”€ logout()                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              â”‚              â”‚              â”‚
â–¼              â–¼              â–¼              â–¼
Login.tsx  EmployeeLogin AdminLogin  CustomerOrder
(Cliente)  (Func)       (Admin)      (Mesa)
â”‚          â”‚            â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€ EmployeeDashboard.tsx
           â”‚  (Gerenciar Pedidos)
           â”‚
           â””â”€ AdminDashboard.tsx
              (Painel Completo)
```

---

## 9. Ciclo de Vida do UsuÃ¡rio

```
NOVO USUÃRIO

Admin cria:
  â”œâ”€ username
  â”œâ”€ email
  â”œâ”€ phone
  â”œâ”€ password
  â”œâ”€ is_admin: false
  â””â”€ is_employee: false (CLIENTE padrÃ£o)
          â”‚
          â–¼
    UsuÃ¡rio pode fazer login
          â”‚
          â–¼
    Admin promove:
    â”œâ”€ Tornar Func (is_employee=true)
    â””â”€ Tornar Admin (is_admin=true)
          â”‚
          â–¼
    UsuÃ¡rio agora tem nova funÃ§Ã£o
          â”‚
          â–¼
    Admin remove funÃ§Ã£o:
    â””â”€ Volta a ser Cliente
          â”‚
          â–¼
    Admin deleta:
    â””â”€ UsuÃ¡rio removido do banco
```

---

## 10. Estrutura de Pastas

```
project/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ contexts/
â”‚   â”‚   â””â”€â”€ AuthContext.tsx
â”‚   â”‚       â”œâ”€ User interface
â”‚   â”‚       â””â”€ login(), logout()
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ supabase.ts
â”‚   â”‚       â”œâ”€ Supabase client
â”‚   â”‚       â””â”€ TypeScript interfaces
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ Login.tsx (Cliente - Mesa)
â”‚   â”‚   â”œâ”€â”€ EmployeeLogin.tsx (FuncionÃ¡rio) âœ¨
â”‚   â”‚   â”œâ”€â”€ AdminLogin.tsx (Admin)
â”‚   â”‚   â”œâ”€â”€ CustomerOrder.tsx (Dashboard Cliente)
â”‚   â”‚   â”œâ”€â”€ EmployeeDashboard.tsx (Dashboard Func) âœ¨
â”‚   â”‚   â””â”€â”€ AdminDashboard.tsx (Dashboard Admin)
â”‚   â”‚
â”‚   â”œâ”€â”€ App.tsx (Roteamento)
â”‚   â””â”€â”€ main.tsx (Entrada)
â”‚
â”œâ”€â”€ supabase/
â”‚   â””â”€â”€ migrations/
â”‚       â”œâ”€â”€ 20260124... (Schema)
â”‚       â”œâ”€â”€ 20260125... (RLS)
â”‚       â”œâ”€â”€ 20260126... (Consolidado)
â”‚       â””â”€â”€ 20260127... (Employee Role) âœ¨
â”‚
â”œâ”€â”€ AUTHENTICATION_SYSTEM.md (1000+ linhas)
â”œâ”€â”€ TECHNICAL_DOCUMENTATION.md (800+ linhas)
â”œâ”€â”€ SETUP_GUIDE.md
â”œâ”€â”€ README_SISTEMA_AUTENTICACAO.md
â”‚
â””â”€â”€ Otros arquivos (package.json, vite.config.ts, etc)
```

---

**Diagrama Visual Criado:** 27 de Janeiro de 2026
**VersÃ£o:** 2.0 Multi-Role System
